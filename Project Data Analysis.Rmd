---
title: "Projet LSTAT2110 - Analyse des données"
author: "Ledune Lucien - 39301400 - DATS2M"
date: "Date de soumission : "
output:
  html_document:
    df_print: paged
---

<!-- En haut, compléter/supprimer selon besoin. -->
<!-- Voir les consignes pour le projet. -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(comment = "")
knitr::opts_chunk$set(fig.align='center')
```

# **Introduction**

Pokémon est une franchise commercialisée par "The pokémon company", une société gérée par Nintendo, Game Freaks et Creatures.  

Même si la franchise à d'abord commercialisé des jeux vidéos, celle-ci s'est étendue à d'autres marchés suite à la popularité montante de ses jeux.  

L'ensemble des jeux pokémon à totalisé plus de 290 millions de ventes dans le monde. 
Les deux premiers jeux pokémon sont sortis en même temps au Japon en 1996. Il s'agissait de Pokémon version Rouge/Bleue. C'est sur cette première génération de 151 spécimens que portera notre analyse.  

Le principe du jeu est celui-ci : On incarne un personnage qui parcours le monde à la recherche de pokémon, le but étant de tous les attraper. Ils servent majoritairement dans des combats, ils possèdent un certains nombre de statistiques (décrites dans la partie suivante) déterminant comment ils se comportent dans les combats. 

Un autre point important est l'évolution. Àprès avoir combattu, certains pokémons peuvent évoluer, c'est à dire changer de forme et de statistiques. (Il pourra être intéressant de voir comment changent les pokémons évolués).

Il existe aussi un type particulier de pokémons, les légendaires, ceux-ci sont généralement plus rare et plus puissants que les autres, aussi nous pourrons essayer de les identifier grâce à l'analyse linéaire discriminante. 
  
  
  
# **Présentation des données, analyse descriptive**

###*Présentation des données*

Pour réaliser ce projet d'analyses de données, nous devions trouver un jeu de données disposant d'au moins 30 individus, 6 variables continues, et une variable discrète pour l'analyse discriminante linéaire.   
  
Le set de données retenu a été trouvé sur www.kaggle.com, et représente les 800 différents pokémons existants dans les 7 générations du jeu, représentés par 13 variables.  

Cependant afin de faciliter l'analyse, certaines lignes et variables seront omises.  

En effet pour l'analyse en composantes principales nous ne conserveront que les variables continues, car celle-ci ne s'applique pas aux variables discrètes (classement).  

Ensuite afin de faciliter l'analyse discriminante linéaire ainsi que la représentation des données nous effectuerons les analyses sur la première génération uniquement, soit les 151 premiers pokémons.

Les différentes variables sont :  

* X. : Un nombre désignant le numéro du pokémon, cette variable sera supprimée car peut pertinante dans notre analyse.   
* Name : Le nom du pokémon, bien qu'ils ne seront pas utilisés à proprement parler dans l'analyse nous les conserverons afin de mieux représenter les pokémons sur certains graphiques. 

* Type 1 : Le type principal du pokémon. 

* Type 2 : L'éventuel type secondaire du pokémon. 

* Total : Une variable représentant la somme des 6 prochaines variables continues. Celle-ce sera omise pour l'analyse en composantes principales car il est évident qu'elle sera corrélée avec les autres variables discrètes comme il s'agit de leur somme. 

* HP : Les points de vie du pokémon, c'est le nombre de dégats qu'il peut prendre. 

* Attack et Sp Attack : Représente la capacité offensive.  

* Defense et Sp Defense : Représente la capacité défensive.

* Speed : C'est la vitesse du pokémon, l'individu ayant la plus grande valeur ici attaquera en premier. 

* Generation : Représente la génération du pokémon, cetta variable nous permettra de sélectionner les pokémons issus de la première génération. 

* Legendary : Boolean (True/False) indiquant si un pokémon est légendaire ou non.

###*Analyse descriptive*  

```{r, echo = FALSE}
#Preparing data
Data = read.csv("https://raw.githubusercontent.com/dfghdf89/Pokemon-Data-Analysis-Project/master/Pokemon.csv", sep = ";")

#Keeping gen1 only
Data = subset(Data, Data$Generation == 1)



```


Pour commencer nous pouvons observer la répartition des pokémons en fonction de certaines variables. Premièrement la distribution des pokémons en fonctions de leur type, ainsi que le nombre de légendaires. 

```{r, echo = FALSE}
library(ggplot2)
ggplot(data = Data, aes(Data$Type.1, stat = "count", fill = Data$Type.1)) + geom_bar() + theme_bw() + scale_fill_manual(values = c("#A6B91A", "#6F35FC", "#F7D02C", "#D685AD", "#C22E28", "#EE8130", "#735797", "#7AC74C", "#E2BF65", "#96D9D6", "#A8A77A", "#A33EA1", "#F95587", "#B6A136", "#6390F0")) + ggtitle("Répartition par type") + xlab("Type") + ylab("Nombre") + theme(plot.title = element_text(hjust = 0.5)) + guides(fill=FALSE)

ggplot(data = Data, aes(Data$Legendary, stat = "count", fill = Data$Legendary)) + geom_bar() + ggtitle("Nombre de pokémons légendaires") + xlab("Légendaire") + ylab("Nombre") + theme(plot.title = element_text(hjust = 0.5)) + guides(fill=FALSE)


```

Nous pouvons observer sur le premier graphique que la répartition des spécimens par type est très inégale, certains type (water, normal,...) disposent d'un grand nombre d'individus contrairement à d'autres (dragon, fairy,...)  
Sur le deuxième graphique nous pouvons voir que les pokémons légendaires sont très peu nombreux (il en existe 4 dans cette génération).  

Le prochain graphique va comparer les pokémons légendaires aux autres en fonction de la somme de leur statistiques (variable "total").

```{r}
ggplot(data = Data, aes(Data$Legendary, Data$Total, colour = Data$Legendary)) + geom_point() + ggtitle("Statistiques légendaires vs normaux") + xlab("Légendaire") + ylab("Total") + theme(plot.title = element_text(hjust = 0.5)) 

```

Il évident au vu du graphique que les pokémons légendaires disposent, en moyenne, de statistiques bien plus élevées. Nous pourrons donc certainement les distinguer (ainsi que de nouveaux individus) des autres grâce à l'analyse discriminante linéaire.   

Nous allons maintenant nous intéresser à la distribution des différentes statistiques. 

```{r}
#total 
plot(density(Data$Total), xlab = "Total", ylab = "Density", main = "Density of Total")
par(mfrow = c(2,3))
plot(density(Data$HP), xlab = "HP", ylab = "Density", main = "Density of HP")
plot(density(Data$Attack), xlab = "Attack", ylab = "Density", main = "Density of Attack")
plot(density(Data$Defense), xlab = "Defense", ylab = "Density", main = "Density of Defense")
plot(density(Data$Sp..Atk), xlab = "Special Attack", ylab = "Density", main = "Density of Special Attack")
plot(density(Data$Sp..Def), xlab = "Special Defense", ylab = "Density", main = "Density of Special Defense")
plot(density(Data$Speed), xlab = "Speed", ylab = "Density", main = "Density of Speed")


```

Nous pouvons voir que dans l'ensemble, les statistiques semblent suivre une loi gaussienne. Avec deux pics autours de 300 et 500 pour le total. (Sûrement expliqué par la différence de moyenne statistique entre un pokémon non-évolué et son évolution).

Regardons maintenant la matrice de corrélations des données. 

```{r}
#Keeping only continues variables
DataPCA = Data[,6:11]

library(corrplot)
corrmat = cor(DataPCA)
corrplot(corrmat, method = "circle")

```

Sur ce graphique, nous pouvons voir que la majorité des variables sont positivement corrélées, ce qui peut vouloir dire que lorsqu'un individu gagne des statistiques, il en gagne de presque tous les types.  
Cependant il y a des exceptions, ainsi la vitesse est négativement corrélée avec les HP et la Défense. Ce résultat est assez intuitif et signifie globalement que plus un individu est rapide, moins il sera résistant.  
```{r}
ggplot(data = Data, aes(Data$Speed, Data$HP)) + geom_point() + ggtitle("Speed vs HP") + xlab("Speed") + ylab("HP") + theme(plot.title = element_text(hjust = 0.5)) + guides(fill=FALSE)

```
Sur le graphique nous voyons que cette corrélation est assez légère.

Voici les autres relations intéressantes : 

* L'attaque et la défense sont positivement corrélées. 
* L'attaque spéciale et la défense spéciale sont également positivement corrélées

```{r}
par(mfrow = c(1,2))
plot(Data$Attack, Data$Defense, xlab = "Attack", ylab = "Defense", main = "Attack vs Defense")
plot(Data$Sp..Atk, Data$Sp..Def, xlab = "Attack Sp.", ylab = "Defense Sp.", main = "Attack Sp. vs Defense Sp.")
```


# Analyse en Composantes Principales

Nous allons maintenant passer à l'analyse en composantes principales de notre jeu de données.  

```{r}
library(knitr)
library(FactoMineR)
eigenvectors = eigen(cor(scale(DataPCA)))
eigenvectors = eigenvectors$vectors
colnames(eigenvectors) = c("E1", "E2", "E3", "E4", "E5", "E6")

res.pca = PCA(as.matrix(DataPCA), ncp = 6, scale = T)

```

####Corrélation des axes et des variables
```{r}
kable(res.pca$var$cor, caption = )
```


# Clustering 



# Analyse des correspondances



# Conclusion



# Annexes